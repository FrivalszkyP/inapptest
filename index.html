<html>
  <body>
    <div id="isinapp"></div>
    <div id="copylink">
      <button id="copylinkbutton">Copy Link</button>
    </div>
    <div id="copylinkFeedbackMessage"></div>
    <script>
      const isInAppBrowser = () => {
        if (!window?.navigator) {
            return false;
        }

        const { navigator } = window;
        const userAgent = navigator.userAgent.toLowerCase();
        const normalizedUserAgent = userAgent.toLowerCase();
        // @ts-expect-error
        const { standalone } = navigator;
        // eslint-disable-next-line prefer-named-capture-group
        const isIos = (/ip(ad|hone|od)/u).test(normalizedUserAgent) || (navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1);
        const isAndroid = (/android/u).test(normalizedUserAgent);
        const isSafari = (/safari/u).test(normalizedUserAgent);

        return ((isAndroid && (/; wv\)/u).test(normalizedUserAgent)) || (isIos && !standalone && !isSafari));
      };

      const copyLink = () => {
        const copyText = window.location.href;
        navigator.clipboard.writeText(copyText).then(() => {
          document.getElementById('copylinkFeedbackMessage').innerText = 'Link copied to clipboard';
        }, () => {
          document.getElementById('copylinkFeedbackMessage').innerText = 'Failed to copy link to clipboard';
        });
      };

      const init = () => {
        if (isInAppBrowser()) {
          document.getElementById('isinapp').innerText = 'In App Browser';
        } else {
          document.getElementById('isinapp').innerText = 'Not In App Browser';
        }

        document.getElementById('copylinkbutton').addEventListener('click', copyLink);
      };

      init();

    </script>
  </body>
</html>
